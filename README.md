# Foodgram

**Foodgram** — это веб-приложение для обмена рецептами и составления списков покупок. Пользователи могут публиковать рецепты, добавлять их в избранное, подписываться на других авторов и создавать списки покупок с учётом необходимых ингредиентов.

#### Основные возможности:
- Авторизация пользователей (включая регистрацию и управление аватаром).
- Создание, редактирование и удаление рецептов.
- Фильтрация рецептов по тегам, авторам, наличию в избранном или корзине покупок.
- Генерация списка покупок с возможностью скачивания.
- Управление подписками на авторов.

Приложение состоит из бэкенда на Django Rest Framework и фронтенда на React SPA. Для хранения данных используется PostgreSQL. Весь проект развёрнут в контейнерах Docker, что упрощает запуск и масштабирование.

Проект доступен на домене: [cuberbug.ru](https://cuberbug.ru).

---

### Разработка и запуск на Linux

Проект может быть быстро запущен и протестирован как локально, так и на веб-сервере. Ниже о том, как это можно сделать.

#### Зависимости

- [Git](https://git-scm.com/)
- [Docker](https://www.docker.com/)
- [Docker Compose](https://docs.docker.com/compose/)

#### Переменные окружения

После клонирования репозитория необходимо создать файл `.env` в корневой директории проекта и заполнить его, указав необходимые переменные окружения. Внутри квадратных скобок будут находиться комментарии:

```
## Django
DJANGO_SECRET_KEY=[секретный ключ]
DEBUG=[булево: включить/выключить дебаг]
ALLOWED_HOSTS=localhost,127.0.0.1 [для запуска на сервере добавить свой ip или домен]
CSRF_TRUSTED_ORIGINS=https://cuberbug.ru [нужен только в случае запуска проекта на сервере]
LANGUAGE_CODE=ru-RU
PAGINATION_SIZE=6
DEV=True [нужен для отладки: позволяет создать суперюзера management-командой]
## Logging
HANDLER_FILE_LEVEL=DEBUG
LOGGER_DJANGO_LEVEL=DEBUG
## Database
# SQLite
SQLITE=False [позволяет переключиться на SQLite при включённом DEBUG]
# PostgreSQL
POSTGRES_DB=foodgram
POSTGRES_USER=foodgram_user
POSTGRES_PASSWORD=foodgram_password
POSTGRES_HOST=db
POSTGRES_PORT=5432
## Docker Compose
# Nginx
GATEWAY_PORTS=8000:80 [для использования локально]
GATEWAY_PORTS_DEV=80:80 [для использовании на сервере]
# Production
REPO_OWNER=cuberbug [для работы с Docker]
## Dev [параметры вашего суперпользователя]
DJANGO_SUPERUSER_USERNAME=admin
DJANGO_SUPERUSER_EMAIL=admin@admin.com
DJANGO_SUPERUSER_PASSWORD=admin
```

После сохранения файла нужно прокинуть символьную ссылку на него в `./infra/`. Находясь в корне репозитория, выполните:

```shell
ln -s .env infra/.env
```

Символьная ссылка необходима для работы `docker-compose`-файлов.

#### Локальный запуск

Для запуска проекта подготовлена автоматизация в виде скриптов.

При первом запуске рекомендуется согласиться на все запросы, где положительный ответ установлен по умолчанию, остальное - по ситуации:

```shell
./infra/start_dev.sh
```

Остановка проекта тоже автоматизирована, предусмотрено удаление созданных проектом томов (за исключением тома с логами):

```shell
./infra/stop_dev.sh
```

`shell_config.sh` - является вспомогательным скриптом, хранящим константы и универсальные функции.


#### Запуск на сервере

Для корректной работы на сервере должен быть установлен и настроен Nginx, который слушает 80 порт и проксирует запросы к вашему домену в контейнер к Nginx из проекта, при этом необходимо использовать предварительно настроенный с указанием ваших данных `docker-compose.production.yml`. Контейнер с Nginx использует переменные окружения в зависимости от того, где подразумевается его работа: локально или на сервере - в последнем случае нужно указать соответствующие порты.

Ниже пример минимальной настройки внешнего (серверного) Nginx:

```
server {
    server_name cuberbug.ru;

    location / {
        proxy_pass http://127.0.0.1:8000;
    }
}
```

В таком случае для переменных окружения потребуется соответствующая настройка портов:

```
GATEWAY_PORTS=8000:80
```

В `docker-compose.production.yml` оставлены комментарии по поводу особенностей его работы.

---

### Авторы

- [Практикум](https://practicum.yandex.ru/) — Front-End React SPA
- Кубышин Александр — Back-End Developer

